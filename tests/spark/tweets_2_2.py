tests = [{'text': ['The remaining steps in the #Brexit process\n\nhttps://t.co/url'], 'retweeted_quoted_user_id': '99999999', 'retweeted_quoted_screen_name': 'user screen name', 'retweet_quoted_status_id': '1111111111111111005', 'mention_user_ids': ['99999999'], 'mention_screen_names': ['user screen name'], 'hashtags': ['brexit'], 'urls': [], 'media': 'https://pbs.twimg.com/ext_tw_video_thumb/1111111111111111002/pu/img/J631NlKRVtNkL1m9.jpg', 'urls_csv': '', 'hashtags_csv': 'Brexit', 'tweet_id': '1111111111111111004', 'tweet_type': 'retweet', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:03Z', 'user_id': '111111111', 'user_screen_name': 'user screen name', 'user_follower_count': 128, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': 'Dublin City, Ireland', 'retweet_count': 0, 'language': 'en', 'favorite_count': 2118, 'has_geo': False, 'has_media': True, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111004', 'parsed_created_at': 'Mon Oct 21 10:13:03 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': False, 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'user_created_at': 'Sat Dec 04 11:53:31 +0000 2010', 'user_default_profile_image': False, 'user_favourites_count': 6409, 'user_friends_count': 217, 'user_listed_count': 1, 'user_statuses_count': 1321, 'user_description': None, 'user_name': 'User Name', 'dataset_id': 'test-df'}, {'text': ['Брексит приближается — шанс для курса Биткойн?\n\nПо мере приближения выхода Великобритании из Великобритании, более известного как Brexit, цена на биткойны также растет. Соответственно... https://t.co/url https://t.co/url'], 'retweeted_quoted_user_id': None, 'retweeted_quoted_screen_name': None, 'retweet_quoted_status_id': None, 'mention_user_ids': [], 'mention_screen_names': [], 'hashtags': [], 'urls': ['http://zonacrypto.ru/novosti/breksit-priblizhaetsja-shans-dlja-kursa-bitkojn/', 'http://twitter.com/i/web/status/1111111111111111008'], 'media': 'https://pbs.twimg.com/media/url', 'urls_csv': 'http://zonacrypto.ru/novosti/breksit-priblizhaetsja-shans-dlja-kursa-bitkojn/ https://twitter.com/i/web/status/1111111111111111008', 'hashtags_csv': '', 'tweet_id': '1111111111111111008', 'tweet_type': 'original', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:11Z', 'user_id': '1111111111111111009', 'user_screen_name': 'user screen name', 'user_follower_count': 10, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': 'Россия', 'retweet_count': 0, 'language': 'ru', 'favorite_count': 0, 'has_geo': False, 'has_media': True, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111008', 'parsed_created_at': 'Mon Oct 21 10:13:11 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': False, 'source': '<a href="https://hooppy.ru" rel="nofollow">Hooppy</a>', 'user_created_at': 'Wed Jun 27 08:50:06 +0000 2018', 'user_default_profile_image': False, 'user_favourites_count': 0, 'user_friends_count': 79, 'user_listed_count': 0, 'user_statuses_count': 10803, 'user_description': 'User description', 'user_name': 'User Name', 'dataset_id': 'test-df'}, {'text': ['2192.\n\nPremijeri Srbije i Kosova sreli su se u Dejtonu, uz posredovanje Metju Palmera IV. \n\nLegenda kaže da je čukundeda američkog pregovarača još početkom XXI veka neuspešno pokušavao da postigne sporazum.\n\nTim povodom Čatam Haus organizuje debatu:\n"Brexit ili Kosovo: šta pre?" https://t.co/url'], 'retweeted_quoted_user_id': None, 'retweeted_quoted_screen_name': None, 'retweet_quoted_status_id': None, 'mention_user_ids': [], 'mention_screen_names': [], 'hashtags': [], 'urls': ['http://twitter.com/i/web/status/1111111111111111011'], 'media': 'https://pbs.twimg.com/media/url', 'urls_csv': 'https://twitter.com/i/web/status/1111111111111111011', 'hashtags_csv': '', 'tweet_id': '1111111111111111011', 'tweet_type': 'original', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:23Z', 'user_id': None, 'user_screen_name': None, 'user_follower_count': None, 'user_verified': None, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': None, 'retweet_count': 0, 'language': 'und', 'favorite_count': 0, 'has_geo': True, 'has_media': True, 'tweet_url': None, 'parsed_created_at': 'Mon Oct 21 10:13:23 +0000 2019', 'coordinates': '', 'place': 'Belgrade, Republic of Serbia', 'possibly_sensitive': False, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'user_created_at': None, 'user_default_profile_image': None, 'user_favourites_count': None, 'user_friends_count': None, 'user_listed_count': None, 'user_statuses_count': None, 'user_description': None, 'user_name': None, 'dataset_id': 'test-df'}, {'text': ['This is key to Remain in a new GE or referendum: defining Johnson deal as something which will drag on Brexit, while the alternative would Just Make It Stop. https://t.co/url'], 'retweeted_quoted_user_id': '33333333', 'retweeted_quoted_screen_name': 'user screen name', 'retweet_quoted_status_id': '1111111111111111106', 'mention_user_ids': ['33333333'], 'mention_screen_names': ['user screen name'], 'hashtags': [], 'urls': [], 'media': '', 'urls_csv': '', 'hashtags_csv': '', 'tweet_id': '1111111111111111101', 'tweet_type': 'retweet', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:02Z', 'user_id': '77777777', 'user_screen_name': 'user screen name', 'user_follower_count': 658, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': 'Ayrshire Scotland.', 'retweet_count': 0, 'language': 'en', 'favorite_count': 384, 'has_geo': False, 'has_media': False, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111101', 'parsed_created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': None, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'user_created_at': 'Sun May 03 18:09:12 +0000 2009', 'user_default_profile_image': False, 'user_favourites_count': 53402, 'user_friends_count': 474, 'user_listed_count': 23, 'user_statuses_count': 41552, 'user_description': 'User description', 'user_name': 'User Name', 'dataset_id': 'test-df'}, {'text': ['Optimista sobre el Brexit, la libra esterlina alcanza un máximo en cinco meses https://t.co/ZEldHtWDf8 #Internacional #Brexit #Diplomacia'], 'retweeted_quoted_user_id': None, 'retweeted_quoted_screen_name': None, 'retweet_quoted_status_id': None, 'mention_user_ids': [], 'mention_screen_names': [], 'hashtags': ['internacional', 'brexit', 'diplomacia'], 'urls': ['http://dlvr.it/rgdmmv'], 'media': '', 'urls_csv': 'http://dlvr.it/RGdMMv', 'hashtags_csv': 'Internacional Brexit Diplomacia', 'tweet_id': '1111111111111111111', 'tweet_type': 'original', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:02Z', 'user_id': '111111111111111112', 'user_screen_name': 'user screen name', 'user_follower_count': 3592, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': 'Madrid, Espagne', 'retweet_count': 0, 'language': 'es', 'favorite_count': 0, 'has_geo': False, 'has_media': False, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111111', 'parsed_created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': False, 'source': '<a href="https://dlvrit.com/" rel="nofollow">dlvr.it</a>', 'user_created_at': 'Wed Aug 09 11:59:46 +0000 2017', 'user_default_profile_image': False, 'user_favourites_count': 0, 'user_friends_count': 6, 'user_listed_count': 53, 'user_statuses_count': 19694, 'user_description': 'User description.', 'user_name': 'User Name', 'dataset_id': 'test-df'}, {'text': ["So Johnson voted twice against Theresa May's deal\nHe voted again for the deal\nHe wants another vote for his crap deal for bankers \nHe says we can only have one vote\nSheer hypocrisy \n#brexit #BrexitDeal #peoplesvote"], 'retweeted_quoted_user_id': '111111111', 'retweeted_quoted_screen_name': 'user screen name', 'retweet_quoted_status_id': '1111111111111111115', 'mention_user_ids': ['111111111'], 'mention_screen_names': ['user screen name'], 'hashtags': ['brexit', 'brexitdeal', 'peoplesvote'], 'urls': [], 'media': '', 'urls_csv': '', 'hashtags_csv': 'brexit BrexitDeal peoplesvote', 'tweet_id': '1111111111111111114', 'tweet_type': 'retweet', 'in_reply_to_user_id': None, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'created_at': '2019-10-21T10:13:02Z', 'user_id': '2222222222', 'user_screen_name': 'user screen name', 'user_follower_count': 3590, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': 'Oldham, England', 'retweet_count': 0, 'language': 'en', 'favorite_count': 3, 'has_geo': False, 'has_media': False, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111114', 'parsed_created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': None, 'source': '<a href="http://twitter.com/#!/download/ipad" rel="nofollow">Twitter for iPad</a>', 'user_created_at': 'Thu Jan 30 18:08:54 +0000 2014', 'user_default_profile_image': False, 'user_favourites_count': 162289, 'user_friends_count': 5000, 'user_listed_count': 3, 'user_statuses_count': 137213, 'user_description': 'User description', 'user_name': 'User Name', 'dataset_id': 'test-df'}, {'text': ["@user screen name @user screen name What is a true Brexit? You voted for andthis is Brexit, albeit episode 73 but it gives you your Brexit. Now you want True Brexit! I laugh because I know you didn't vote for true Brexit, you didn't vote for this Brexit either, in all honesty, did you know what you voted for?"], 'retweeted_quoted_user_id': None, 'retweeted_quoted_screen_name': None, 'retweet_quoted_status_id': None, 'mention_user_ids': ['3333333333', '111111111111111117'], 'mention_screen_names': ['user screen name', 'user screen name'], 'hashtags': [], 'urls': ['http://twitter.com/i/web/status/1111111111111111116'], 'media': '', 'urls_csv': 'https://twitter.com/i/web/status/1111111111111111116', 'hashtags_csv': '', 'tweet_id': '1111111111111111116', 'tweet_type': 'reply', 'in_reply_to_user_id': '3333333333', 'in_reply_to_screen_name': 'user screen name', 'in_reply_to_status_id': '1111111111111111118', 'created_at': '2019-10-21T10:13:03Z', 'user_id': '1111111111111111119', 'user_screen_name': 'user screen name', 'user_follower_count': 0, 'user_verified': False, 'user_language': None, 'user_utc_offset': None, 'user_time_zone': None, 'user_location': None, 'retweet_count': 0, 'language': 'en', 'favorite_count': 0, 'has_geo': False, 'has_media': False, 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111116', 'parsed_created_at': 'Mon Oct 21 10:13:03 +0000 2019', 'coordinates': '', 'place': None, 'possibly_sensitive': None, 'source': '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'user_created_at': 'Thu Aug 08 10:51:59 +0000 2019', 'user_default_profile_image': False, 'user_favourites_count': 17, 'user_friends_count': 8, 'user_listed_count': 0, 'user_statuses_count': 416, 'user_description': None, 'user_name': 'User Name', 'dataset_id': 'test-df'}]
tests_csv=[{'id': '1111111111111111004', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111004', 'parsed_created_at': '2019-10-21T10:13:03Z', 'created_at': 'Mon Oct 21 10:13:03 +0000 2019', 'user_screen_name': 'user screen name', 'text': 'The remaining steps in the #Brexit process  https://t.co/url', 'tweet_type': 'retweet', 'coordinates': '', 'hashtags': 'Brexit', 'media': 'https://pbs.twimg.com/ext_tw_video_thumb/1111111111111111002/pu/img/J631NlKRVtNkL1m9.jpg', 'urls': '', 'favorite_count': 2118, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'en', 'place': None, 'possibly_sensitive': False, 'retweet_count': 0, 'retweet_or_quote_id': '1111111111111111005', 'retweet_or_quote_screen_name': 'user screen name', 'retweet_or_quote_user_id': '99999999', 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'user_id': '111111111', 'user_created_at': 'Sat Dec 04 11:53:31 +0000 2010', 'user_default_profile_image': False, 'user_description': None, 'user_favourites_count': 6409, 'user_followers_count': 128, 'user_friends_count': 217, 'user_listed_count': 1, 'user_location': 'Dublin City, Ireland', 'user_name': 'User Name', 'user_statuses_count': 1321, 'user_time_zone': None, 'user_verified': False}, {'id': '1111111111111111008', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111008', 'parsed_created_at': '2019-10-21T10:13:11Z', 'created_at': 'Mon Oct 21 10:13:11 +0000 2019', 'user_screen_name': 'user screen name', 'text': 'Брексит приближается — шанс для курса Биткойн?  По мере приближения выхода Великобритании из Великобритании, более известного как Brexit, цена на биткойны также растет. Соответственно... https://t.co/url https://t.co/url', 'tweet_type': 'original', 'coordinates': '', 'hashtags': '', 'media': 'https://pbs.twimg.com/media/url', 'urls': 'http://zonacrypto.ru/novosti/breksit-priblizhaetsja-shans-dlja-kursa-bitkojn/ https://twitter.com/i/web/status/1111111111111111008', 'favorite_count': 0, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'ru', 'place': None, 'possibly_sensitive': False, 'retweet_count': 0, 'retweet_or_quote_id': None, 'retweet_or_quote_screen_name': None, 'retweet_or_quote_user_id': None, 'source': '<a href="https://hooppy.ru" rel="nofollow">Hooppy</a>', 'user_id': '1111111111111111009', 'user_created_at': 'Wed Jun 27 08:50:06 +0000 2018', 'user_default_profile_image': False, 'user_description': 'User description', 'user_favourites_count': 0, 'user_followers_count': 10, 'user_friends_count': 79, 'user_listed_count': 0, 'user_location': 'Россия', 'user_name': 'User Name', 'user_statuses_count': 10803, 'user_time_zone': None, 'user_verified': False}, {'id': '1111111111111111011', 'tweet_url': None, 'parsed_created_at': '2019-10-21T10:13:23Z', 'created_at': 'Mon Oct 21 10:13:23 +0000 2019', 'user_screen_name': None, 'text': '2192.  Premijeri Srbije i Kosova sreli su se u Dejtonu, uz posredovanje Metju Palmera IV.   Legenda kaže da je čukundeda američkog pregovarača još početkom XXI veka neuspešno pokušavao da postigne sporazum.  Tim povodom Čatam Haus organizuje debatu: "Brexit ili Kosovo: šta pre?" https://t.co/url', 'tweet_type': 'original', 'coordinates': '', 'hashtags': '', 'media': 'https://pbs.twimg.com/media/url', 'urls': 'https://twitter.com/i/web/status/1111111111111111011', 'favorite_count': 0, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'und', 'place': 'Belgrade, Republic of Serbia', 'possibly_sensitive': False, 'retweet_count': 0, 'retweet_or_quote_id': None, 'retweet_or_quote_screen_name': None, 'retweet_or_quote_user_id': None, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'user_id': None, 'user_created_at': None, 'user_default_profile_image': None, 'user_description': None, 'user_favourites_count': None, 'user_followers_count': None, 'user_friends_count': None, 'user_listed_count': None, 'user_location': None, 'user_name': None, 'user_statuses_count': None, 'user_time_zone': None, 'user_verified': None}, {'id': '1111111111111111101', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111101', 'parsed_created_at': '2019-10-21T10:13:02Z', 'created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'user_screen_name': 'user screen name', 'text': 'This is key to Remain in a new GE or referendum: defining Johnson deal as something which will drag on Brexit, while the alternative would Just Make It Stop. https://t.co/url', 'tweet_type': 'retweet', 'coordinates': '', 'hashtags': '', 'media': '', 'urls': '', 'favorite_count': 384, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'en', 'place': None, 'possibly_sensitive': None, 'retweet_count': 0, 'retweet_or_quote_id': '1111111111111111106', 'retweet_or_quote_screen_name': 'user screen name', 'retweet_or_quote_user_id': '33333333', 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'user_id': '77777777', 'user_created_at': 'Sun May 03 18:09:12 +0000 2009', 'user_default_profile_image': False, 'user_description': 'User description', 'user_favourites_count': 53402, 'user_followers_count': 658, 'user_friends_count': 474, 'user_listed_count': 23, 'user_location': 'Ayrshire Scotland.', 'user_name': 'User Name', 'user_statuses_count': 41552, 'user_time_zone': None, 'user_verified': False}, {'id': '1111111111111111111', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111111', 'parsed_created_at': '2019-10-21T10:13:02Z', 'created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'user_screen_name': 'user screen name', 'text': 'Optimista sobre el Brexit, la libra esterlina alcanza un máximo en cinco meses https://t.co/ZEldHtWDf8 #Internacional #Brexit #Diplomacia', 'tweet_type': 'original', 'coordinates': '', 'hashtags': 'Internacional Brexit Diplomacia', 'media': '', 'urls': 'http://dlvr.it/RGdMMv', 'favorite_count': 0, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'es', 'place': None, 'possibly_sensitive': False, 'retweet_count': 0, 'retweet_or_quote_id': None, 'retweet_or_quote_screen_name': None, 'retweet_or_quote_user_id': None, 'source': '<a href="https://dlvrit.com/" rel="nofollow">dlvr.it</a>', 'user_id': '111111111111111112', 'user_created_at': 'Wed Aug 09 11:59:46 +0000 2017', 'user_default_profile_image': False, 'user_description': 'User description.', 'user_favourites_count': 0, 'user_followers_count': 3592, 'user_friends_count': 6, 'user_listed_count': 53, 'user_location': 'Madrid, Espagne', 'user_name': 'User Name', 'user_statuses_count': 19694, 'user_time_zone': None, 'user_verified': False}, {'id': '1111111111111111114', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111114', 'parsed_created_at': '2019-10-21T10:13:02Z', 'created_at': 'Mon Oct 21 10:13:02 +0000 2019', 'user_screen_name': 'user screen name', 'text': "So Johnson voted twice against Theresa May's deal He voted again for the deal He wants another vote for his crap deal for bankers  He says we can only have one vote Sheer hypocrisy  #brexit #BrexitDeal #peoplesvote", 'tweet_type': 'retweet', 'coordinates': '', 'hashtags': 'brexit BrexitDeal peoplesvote', 'media': '', 'urls': '', 'favorite_count': 3, 'in_reply_to_screen_name': None, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'lang': 'en', 'place': None, 'possibly_sensitive': None, 'retweet_count': 0, 'retweet_or_quote_id': '1111111111111111115', 'retweet_or_quote_screen_name': 'user screen name', 'retweet_or_quote_user_id': '111111111', 'source': '<a href="http://twitter.com/#!/download/ipad" rel="nofollow">Twitter for iPad</a>', 'user_id': '2222222222', 'user_created_at': 'Thu Jan 30 18:08:54 +0000 2014', 'user_default_profile_image': False, 'user_description': 'User description', 'user_favourites_count': 162289, 'user_followers_count': 3590, 'user_friends_count': 5000, 'user_listed_count': 3, 'user_location': 'Oldham, England', 'user_name': 'User Name', 'user_statuses_count': 137213, 'user_time_zone': None, 'user_verified': False}, {'id': '1111111111111111116', 'tweet_url': 'https://twitter.com/user screen name/status/1111111111111111116', 'parsed_created_at': '2019-10-21T10:13:03Z', 'created_at': 'Mon Oct 21 10:13:03 +0000 2019', 'user_screen_name': 'user screen name', 'text': "@user screen name @user screen name What is a true Brexit? You voted for andthis is Brexit, albeit episode 73 but it gives you your Brexit. Now you want True Brexit! I laugh because I know you didn't vote for true Brexit, you didn't vote for this Brexit either, in all honesty, did you know what you voted for?", 'tweet_type': 'reply', 'coordinates': '', 'hashtags': '', 'media': '', 'urls': 'https://twitter.com/i/web/status/1111111111111111116', 'favorite_count': 0, 'in_reply_to_screen_name': 'user screen name', 'in_reply_to_status_id': '1111111111111111118', 'in_reply_to_user_id': '3333333333', 'lang': 'en', 'place': None, 'possibly_sensitive': None, 'retweet_count': 0, 'retweet_or_quote_id': None, 'retweet_or_quote_screen_name': None, 'retweet_or_quote_user_id': None, 'source': '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'user_id': '1111111111111111119', 'user_created_at': 'Thu Aug 08 10:51:59 +0000 2019', 'user_default_profile_image': False, 'user_description': None, 'user_favourites_count': 17, 'user_followers_count': 0, 'user_friends_count': 8, 'user_listed_count': 0, 'user_location': None, 'user_name': 'User Name', 'user_statuses_count': 416, 'user_time_zone': None, 'user_verified': False}]